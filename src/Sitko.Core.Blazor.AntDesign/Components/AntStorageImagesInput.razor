@typeparam TValue
@inherits BaseAntStorageImageInput<TValue>
<AntDesign.Spin Spinning="IsSpinning">
    <div class="ant-upload-list ant-upload-list-picture-card ant-upload-list-@Size">
        @foreach (var file in _images)
        {
            var tips = file.StorageItem.FileName;
            <AntDesign.Tooltip Title="tips">
                <Unbound Context="tooltipRef">
                    <div Class="ant-upload-list-picture-card-container">

                        <div class="ant-upload-list-item ant-upload-list-item-done  ant-upload-list-item-list-type-picture-card">
                            <div class="ant-upload-list-item-info">
                                <span class="ant-upload-span">
                                    @{
                                        <a class="ant-upload-list-item-thumbnail" href="@file.Url" target="_blank" rel="noopener noreferrer">
                                            @if (Avatar)
                                            {
                                                <AntDesign.Avatar Size="@AvatarSize" Src="@file.SmallPreviewUrl" Alt="@file.StorageItem.FileName" Class="ant-upload-list-item-image"/>
                                            }
                                            else
                                            {
                                                <img src="@file.SmallPreviewUrl" alt="@file.StorageItem.FileName" class="ant-upload-list-item-image"/>
                                            }
                                        </a>
                                    }
                                    <a target="_blank" rel="noopener noreferrer" class="ant-upload-list-item-name" title="@file.StorageItem.FileName" href="@file.Url">@file.StorageItem.FileName</a>
                                </span>
                            </div>

                            <span class="ant-upload-list-item-actions">
                                @if (ShowOrdering)
                                {
                                    <button title="@LeftText" type="button" class="ant-btn ant-btn-text ant-btn-sm ant-btn-icon-only ant-upload-list-item-card-actions-btn" @onclick="() => MoveLeft(file)" disabled="@(!CanMoveLeft(file))">
                                        <AntDesign.Icon Type="left"/>
                                    </button>
                                }
                                <a target="_blank" rel="noopener noreferrer" title="@PreviewText" @onclick="() => PreviewFile(file)">
                                    <AntDesign.Icon Type="eye"/>
                                </a>
                                <button title="@RemoveText" type="button" class="ant-btn ant-btn-text ant-btn-sm ant-btn-icon-only ant-upload-list-item-card-actions-btn" @onclick="() => RemoveFile(file)">
                                    <AntDesign.Icon Type="delete"/>
                                </button>
                                @if (ShowOrdering)
                                {
                                    <button title="@RightText" type="button" class="ant-btn ant-btn-text ant-btn-sm ant-btn-icon-only ant-upload-list-item-card-actions-btn" @onclick="() => MoveRight(file)" disabled="@(!CanMoveRight(file))">
                                        <AntDesign.Icon Type="right"/>
                                    </button>
                                }
                            </span>
                        </div>
                    </div>
                </Unbound>
            </AntDesign.Tooltip>
        }
        @if (ShowUpload)
        {
            <CascadingValue Value="this" IsFixed="true">
                <AntStorageItemsInput
                    @ref="FileInput"
                    TValue="TValue"
                    Storage="@Storage"
                    MaxFileSize="MaxFileSize"
                    MaxAllowedFiles="@MaxFilesToUpload"
                    ContentTypes="@ContentTypes"
                    ListType="picture-card"
                    GenerateMetadata="@((request, stream) => GenerateMetadataAsync(request, stream))"
                    @bind-Value="Items"
                    UploadPath="@UploadPath"
                    OnChange="@OnChangeAsync">
                    <div>
                        <AntDesign.Icon Spin="IsSpinning" Type="@(IsSpinning ? "Loading" : "plus")"></AntDesign.Icon>
                        <div className="ant-upload-text">@UploadText</div>
                    </div>
                </AntStorageItemsInput>
            </CascadingValue>
        }
        <AntDesign.Modal Visible="PreviewVisible"
                         Title="@PreviewTitle"
                         Footer="null" OnCancel="@(() => PreviewVisible = false)">
            <img style="width: 100%" src="@ImgUrl" alt="@PreviewTitle"/>
        </AntDesign.Modal>
    </div>
</AntDesign.Spin>
