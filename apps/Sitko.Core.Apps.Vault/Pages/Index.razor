@page "/"
@using Microsoft.Extensions.Options
@using Microsoft.Extensions.Logging
@using Sitko.Core.IdProvider
@inject IOptionsMonitor<TestConfig> TestConfig
@inject ILogger<Index> _logger
@inject IIdProvider _idProvider;

<h1>Hello, world!</h1>

Welcome to your new app.
<br/>
Foo: @TestConfig.CurrentValue.Foo<br/>
Bar: @TestConfig.CurrentValue.Bar<br/>
@_idProvider

<SurveyPrompt Title="How is Blazor working for you?"/>

@code
{
    protected override void OnInitialized()
    {
        base.OnInitialized();
        TestConfig.OnChange(config =>
        {
            //StateHasChanged();
            _logger.LogInformation("New config: {@Config}", config);
            InvokeAsync(StateHasChanged);
        });
    }
}
